import type { NextPage } from "next";
import Head from "next/head";
import Searchbar from "@components/Searchbar";
import { useRouter } from "next/router";
import useSWR from "swr";
import fetcher from "@lib/fetcher";
import Loading from "@components/icons/Loading";
import Result from "@components/Results/Result";

const Home: NextPage = () => {
  const router = useRouter();
  const { q, sort } = router.query;
  const { data } = useSWR(`/search?q=${q ?? ""}`, fetcher);

  return (
    <div className="bg-blue-100">
      <Head>
        <title>Wyniki wyszukiwania: {q}</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main className="min-h-screen p-32">
        <Searchbar className="mx-auto" />
        <div className="my-4 max-w-lg mx-auto">
          {!data ? (
            <Loading className="animate-spin w-12 mx-auto my-8" />
          ) : (
            <div>
              <span className="text-gray-500">Wyniki wyszukiwania: {q}</span>
              <ul className="mt-4 space-y-4">
                {data.map((item: any) => (
                  <Result key={item} item={item} />
                ))}
              </ul>
            </div>
          )}
        </div>
      </main>
    </div>
  );
};

export default Home;
